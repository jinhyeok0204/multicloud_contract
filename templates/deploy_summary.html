{% extends 'base.html' %}

{% block title %}배포 명세서{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card mt-5 shadow-lg">
            <div class="card-body">
                <h2 class="text-center mb-4">배포 명세서</h2>

                <ul class="list-group list-group-flush mb-4">
                    <li class="list-group-item">
                        <strong>선택한 CSP:</strong>
                        <span class="text-primary">{{ csp_list | join(', ') }}</span>
                    </li>
                    <li class="list-group-item">
                        <strong>최적 배포 위치 (CSP 경로):</strong>
                        <span class="text-success">{{ only_best_route | join(' <-> ') }}</span>
                    </li>
                    <li class="list-group-item">
                        <strong>가상머신 개수:</strong>
                        <span class="text-info-emphasis">{{ vm_count }}</span>
                    </li>
                    <li class="list-group-item">
                        <strong>비용 상한:</strong>
                        <span class="text-warning">{{ cost_limit }} USD</span>
                    </li>
                    <li class="list-group-item">
                        <strong>RTT 상한:</strong>
                        <span class="text-warning">{{ rtt_limit }} ms</span>
                    </li>
                    <li class="list-group-item">
                        <strong>총 비용:</strong>
                        <span class="text-danger">{{ total_cost }} USD/day</span>
                    </li>
                    <li class="list-group-item">
                        <strong>총 RTT:</strong>
                        <span class="text-danger">{{ total_rtt }} ms</span>
                    </li>
                </ul>

                <form action="/deploy" method="POST">
                    <!-- 숨겨진 필드 -->
                    <input type="hidden" name="best_route" value="{{ best_route }}">
                    <input type="hidden" name="csp_list" value="{{ csp_list }}">
                    <input type="hidden" name="vm_count" value="{{ vm_count }}">
                    <input type="hidden" name="cost_limit" value="{{ cost_limit }}">
                    <input type="hidden" name="rtt_limit" value="{{ rtt_limit }}">
                    <input type="hidden" name="total_rtt" value="{{ total_rtt }}">
                    <input type="hidden" name="total_cost" value="{{ total_cost }}">

                    {% for csp, regions in region_map.items() %}
                        {% for region in regions %}
                            <input type="hidden" name="region_{{ csp }}" value="{{ region }}">
                        {% endfor %}
                    {% endfor %}

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg">확인하고 배포 진행</button>
                        <a href="/deploy" class="btn btn-secondary btn-lg">취소</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
